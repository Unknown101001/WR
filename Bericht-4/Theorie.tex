% !TeX root = Bericht_main.tex
\subsection{Die Konvektions-Reaktions-Diffusions-Gleichung}
Wir wollen, im Vergleich zum vorherigen Kapitel, neben dem Transport einer Substanz nun auch Diffusion und chemische Reaktionen der Substanz simulieren. Dazu sei die folgenden Größen vorgegeben:
\begin{align*}
&\text{\underline{\textbf{Geg.:}}}\\
&&&&&\Omega \subseteq \R^d \text{ Gebiet}\\
&&\text{\defi{Diffusionstensor}} &&&\kappa_c:\Omega \to \R^{d \times d}_{\sym}\text{ mit } \kappa_c^T \equiv \kappa_c \text{ und }\\
								&&&&& \qquad \exists \ \lambda_c > 0 \ \forall \ y \in \R^d: y^T \kappa_c y \geq \lambda_c \abs{y}^2\\
&&\text{\defi{Flussvektor}} &&&q:\Omega \to \R^d \text{ mit } \dive(q) = 0\\
&&\text{\defi{Reaktionsrate}} &&&r:\Omega\times[0,T]\times\R \to \R\\
&\text{\underline{\textbf{Ges.:}}}\\
	&&\text{\defi{Konzentrationsrate der Stoffes}} &&&c:[0,T]\times\Omega \to \R
\end{align*}
Aus der Physik erhalten wir wieder Bilanz- und Konstitutionsgleichungen:\\
\underline{\textbf{Bilanzgleichung:}}
\begin{gather*}
\forall \ (t_0,t_1)\times K \subseteq [0,T] \times \Omega: \\
\underbrace{\int_K \left( c(t_1,x) - c(t_0,x) \right) \diff x}_{\text{Konzentrationsänderung auf } K\text{ in } (t_0,t_1)} + \underbrace{\int_{t_0}^{t_1} \oint_{\partial K} \Psi(c) \cdot \nu \diff a \diff t }_{\text{Konzentrationsänderung auf dem Rand } \partial K \text{ in } (t_0,t_1) } \\
= \underbrace{\int_{t_0}^{t_1} \int_K r(t,x,c(t,x)) \diff x \diff t}_{\text{Reaktion (Produktion und Abbau) auf } K \text{ in } (t_0,t_1) }
\end{gather*}
\underline{\textbf{Konstitutionsgl.:}}
\begin{gather*}
	\Psi(c) = \underbrace{c \cdot q}_{\text{vgl. \enquote{Transportgl}}} - \underbrace{\kappa_c \nabla c}_{vgl \enquote{Potentialströme}}
\end{gather*}
Es folgt, die als \defi{Konvektions-Reaktions-Diffusions-Gleichung} bezeichnete Gleichung
\[ \partial_t c + \dive(c q - \kappa_c \nabla c) = r(c) \text{ in } (0,T) \times \Omega \]
Wie sonst auch geben wir uns auch Anfangs- und Randwerte in Form von $ c_0, c_D, g_N, g_R $vor und erhalten das Problem
\begin{gather*}
	\text{Bestimmme } c:[0,T] \times \Omega \to \R \text{, sodass gilt}\\
	\KDR \begin{cases}
		\text{\textbf{KDR-Gleichung: }}&\partial_t c + \dive(c q - \kappa_c \nabla c) = r(c) \text{ in } (0,T) \times \Omega\\
		\text{\textbf{Anfangswert: }} &c(0,x) = c_0(x) \text{ in } \Omega\\
		\text{\textbf{Randwert:}}\\
		\qquad \text{Dirichlet: } &c(t,x) = c_D(t,x) \text{ auf } (0,T) \times \GammaD \\
		\qquad \text{Neumann: } &-\kappa_c \nabla c(t,x) \cdot \nu = g_N(t,x) \text{ auf } (0,T) \times \GammaN \\
		\qquad \text{Robin: } &-\kappa_c \nabla c(t,x) \cdot \nu + \alpha_R c(t,x) = g_R(t,x) \text{ auf } (0,T) \times \GammaR
	\end{cases}\\
	\text{wobei } \Omega = \GammaD \cupdot \GammaN \cupdot \GammaR
\end{gather*}

\begin{remark}
	(Modellierung mit $ r $)
	\begin{itemize}
		\item $ r $ unabhängig von $ c $, also $ r(t,x,c) = r(t,x) \begin{cases}
		> 0, &\text{Quelle}\\
		< 0, &\text{Senke}
		\end{cases} $
		\item $ r(t,x,c) = r_0 c $ für $ r_0 = \text{const.} \begin{cases}
		> 0, &\text{exp. Wachstum}\\
		< 0, &\text{exp. Zerfall}
		\end{cases} $
	\end{itemize}
\end{remark}

\begin{remark}
	(Durch Modell abgedeckte Teilprobleme)
	\begin{align*}
	&\text{Transport/Konvektion} & \partial_t c + \dive(cq) &= 0\\
	&\text{Reaktion} & \partial_t c &= r(c)\\
	&\text{Diffusion} & \partial_t c &= \dive(\kappa_c \nabla c)
	\end{align*}
\end{remark}

\begin{Lemma} \label{schwache Formulierung zu KDR}
	(Schwache Formulierung zu $ \KDR $)\\
	Sei c eine Lösung vom Problem $ \KDR $ (d.h. $ c(0,\cdot) \equiv c_0 \text{ in } \Omega $ und $ c_{|\GammaD} \equiv c_D \text{ in } (0,T)~\times~\GammaD $).
	
	Dann gilt $ \forall t \in (0,T) $
	\begin{gather*}
		\int_\Omega \left( \partial_t c \, \phi + \kappa_c \nabla c \cdot \nabla \phi + \nabla c \cdot q \phi \right) \diff x + \oint_{\GammaR} \alpha_R \, c \, \phi \diff a\\ = \int_\Omega r(c) \phi \diff x + \oint_{\GammaN} g_N \phi \diff a + \oint_{\GammaR} g_R \phi \diff a
	\end{gather*}
	für alle Testfunktionen $ \phi $  mit $ \phi_{|\GammaD} = 0 $.
\end{Lemma}

Wir schreiben das Problem $ \KDR $, genauer die schwache Formulierung von $ \KDR $ aus Lemma \ref{schwache Formulierung zu KDR}, mithilfe der folgende Operatoren um
\begin{define}(Operatoren für KDR)
	\begin{itemize}
		\item Definiere A durch
		\[ (A\, c , \phi)_\Omega = \int_\Omega (\kappa_c \nabla c \cdot \nabla \phi + \nabla c \cdot q \, \phi ) \diff x + \oint_{\GammaR} \alpha_R \, c \, \phi \diff a  \]
		\item Definiere M durch
		\[ (M \, c, \phi)_\Omega = \int_\Omega c \, \phi \diff x \]
		\item Definiere R durch
		\[ (R\, c, \phi)_\Omega = \int_\Omega r(c) \, \phi \diff x + \oint_{\GammaN} g_N \, \phi \diff a + \oint_{\GammaR} g_R \, \phi \diff a \]
	\end{itemize}
	für alle Testfunktionen $ \phi $ mit $ \phi_{|\GammaD} = 0 $.
\end{define}

Wir erhalten somit die alternative Formulierung:
\begin{gather*}
	\text{Bestimme } c:[0,T] \times \Omega \to \R \text{, sodass gilt}\\
	\OpKDR\begin{cases}
		(M \partial_t c, \phi)_\Omega + (A c, \phi)_\Omega = (R c, \phi)_\Omega 
	\end{cases}\\
	\text{für alle Testfunktionen } \phi \text{ mit } \phi_{|\GammaD} = 0.
\end{gather*}

\subsection{Diskretisierung der KDR-Gleichung}

\subsection{Analyse für verschwindende Diffusion: $ \kappa_c \to 0 $}
Wir betrachten die verschwindende Diffusion ($ \kappa_c \ to 0 $) nur im Spezialfall
\begin{itemize}
	\item  $ \exists \kappa_0 > 0 (const.): \kappa_c = \kappa_0 \, I_n $ (stationärer Diffusion)
	\item $ \GammaR = \Gammaout $
	\item $ \alpha_R = q \cdot n $
	\item $ g_R = 0 $
	\item $ r = 0 $
\end{itemize}
und erhalten somit das Problem
\begin{gather*}
	\text{Bestimme }  c:[0,T] \times \Omega \to \R \text{, sodass gilt}\\
	\sDKDR\begin{cases}
		\partial_t c + \dive(c q - \kappa_0 \nabla c) = 0 &\text{, in } (0,T) \time \Omega\\
		c(0) = c_0  &\text{, in } \Omega\\
		c = c_D &\text{, auf } (0,T) \times \GammaD \\
		\kappa_0 \nabla c \cdot n + (q \cdot n) c = 0 &\text{, auf } (0,T) \times \GammaR
	\end{cases}
\end{gather*}

%\begin{examples}(in 1D)
	
%	Mit $ \Omega = (0,1), q \equiv 1, \kappa_0 > 0, \GammaD = \{0\} \text{ und } \GammaR = \{1\}$ gilt für $ \sDKDR $
%	\begin{gather*}
%	\text{Bestimme }  c:[0,T] \times \Omega \to \R \text{, sodass gilt}\\
%	\begin{cases}
%		\partial_t c + \dive(c q - \kappa_0 \nabla c) = 0 &\text{, in } (0,T) \time \Omega\\
%		c(0) = c_0  &\text{, in } \Omega\\
%		c = c_D &\text{, auf } (0,T) \times \GammaD \\
%		\kappa_0 \nabla c \cdot n + (q \cdot n) c = 0 &\text{, auf } (0,T) \times \GammaR
%	\end{cases}
%	\end{gather*}
%	Außerdem sei $ \kappa_0 $ sehr klein
%	
%	Dann ist die Lösung von $ \sDKDR $
%\end{examples}

\begin{Lemma}(A-Priori-Schranke)
	
	Es gilt
	\begin{align*}
		\int_\Omega \abs{c(T)}^2 \diff x \leq \int_\Omega \abs{c_0}^2 + \int_{0}^{T} \left( \oint_{\GammaD} c_D^2 \abs{q \cdot n} \diff a + 2 \oint_{\GammaD} \kappa_0 \nabla c \cdot n \, c_D \diff a\right) \diff t
	\end{align*}
\end{Lemma}

\begin{Lemma}(Konvergenz für $ \kappa_0 \to 0 $)
	
	Sei $ c $ eine Lösung von $ \sDKDR $ und $ \rho $ eine Lösung von $ \lTG $, also 
	\[ \partial_t \rho + \dive(\rho q) = 0, \rho = \rho_0 = c_D \text{ auf } \GammaD \text{ und }  \rho(0) = \rho_0 = c_0.  \]
	
	Dann gilt 
	\[ \int_\Omega \abs{c(T) - \rho(T)}^2 \diff x \leq \kappa_0 \int_{0}^{T} \norm{\nabla c}_\Omega\, \norm{\nabla(\rho - c)}_\Omega \diff t \]
\end{Lemma}

\begin{Korollar}~
	
	Falls $ \norm{\nabla c}_\Omega $ und $ \norm{\nabla \rho}_\Omega $ unabhängig von $ \kappa_0 $ beschränkt sind, folgt
	\[ c \stackrel{\mathcal{L}^2}{\to} \rho \ (\kappa_0 \to 0) \]
\end{Korollar}
\subsection{Streamline-Upwind-Petrov-Galerkin}


